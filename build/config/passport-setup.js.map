{"version":3,"sources":["../../src/config/passport-setup.js"],"names":["GoogleStrategy","require","Strategy","passport","serializeUser","user","done","_id","deserializeUser","console","log","User","findById","err","use","clientID","KEYS","GOOGLE_ID","clientSecret","GOOGLE_SECRET","callbackURL","SERVER_URL","accessToken","refreshToken","profile","findOrCreate","id","email","_json","name","imageUrl","picture","admin"],"mappings":";;AAAA;;AACA;;AACA;;;;AAEA,IAAMA,cAAc,GAAGC,OAAO,CAAC,yBAAD,CAAP,CAAmCC,QAA1D,C,CAEA;;;AACAC,qBAASC,aAAT,CAAuB,UAACC,IAAD,EAAOC,IAAP,EAAgB;AACnCA,EAAAA,IAAI,CAAC,IAAD,EAAOD,IAAI,CAACE,GAAZ,CAAJ;AACH,CAFD;;AAIAJ,qBAASK,eAAT,CAAyB,UAACD,GAAD,EAAMD,IAAN,EAAe;AACpCG,EAAAA,OAAO,CAACC,GAAR,CAAYH,GAAZ;;AACAI,mBAAKC,QAAL,CAAcL,GAAd,EAAmB,UAASM,GAAT,EAAcR,IAAd,EAAoB;AACnCC,IAAAA,IAAI,CAACO,GAAD,EAAMR,IAAN,CAAJ;AACH,GAFD;AAGH,CALD;;AAOAF,qBAASW,GAAT,CACI,IAAId,cAAJ,CACI;AACIe,EAAAA,QAAQ,EAAEC,iBAAKC,SADnB;AAEIC,EAAAA,YAAY,EAAEF,iBAAKG,aAFvB;AAGIC,EAAAA,WAAW,YAAKJ,iBAAKK,UAAV;AAHf,CADJ,EAMI,UAACC,WAAD,EAAcC,YAAd,EAA4BC,OAA5B,EAAqClB,IAArC,EAA8C;AAC1CK,mBAAKc,YAAL,CAAkB;AACdC,IAAAA,EAAE,EAAEF,OAAO,CAACE;AADE,GAAlB,EAEG;AACCC,IAAAA,KAAK,EAAEH,OAAO,CAACI,KAAR,CAAcD,KADtB;AAECE,IAAAA,IAAI,EAAEL,OAAO,CAACI,KAAR,CAAcC,IAFrB;AAGCC,IAAAA,QAAQ,EAAEN,OAAO,CAACI,KAAR,CAAcG,OAHzB;AAICC,IAAAA,KAAK,EAAE;AAJR,GAFH,EAOG,UAACnB,GAAD,EAAMR,IAAN,EAAe;AACd,QAAGQ,GAAH,EAAQ;AACJJ,MAAAA,OAAO,CAACC,GAAR,CAAYG,GAAZ;AACH,KAFD,MAEO;AACH,aAAOP,IAAI,CAACO,GAAD,EAAMR,IAAN,CAAX;AACH;AACJ,GAbD;AAcH,CArBL,CADJ","sourcesContent":["import passport from \"passport\"\nimport User from \"../models/user\"\nimport KEYS from \"./keys\"\n\nconst GoogleStrategy = require(\"passport-google-oauth20\").Strategy\n\n// Setup Google Strategy\npassport.serializeUser((user, done) => {\n    done(null, user._id)\n})\n\npassport.deserializeUser((_id, done) => {\n    console.log(_id)\n    User.findById(_id, function(err, user) {\n        done(err, user)\n    })\n})\n\npassport.use(\n    new GoogleStrategy(\n        {\n            clientID: KEYS.GOOGLE_ID,\n            clientSecret: KEYS.GOOGLE_SECRET,\n            callbackURL: `${KEYS.SERVER_URL}/auth/google/redirect`,\n        },\n        (accessToken, refreshToken, profile, done) => {\n            User.findOrCreate({\n                id: profile.id\n            }, {\n                email: profile._json.email,\n                name: profile._json.name,\n                imageUrl: profile._json.picture,\n                admin: false\n            }, (err, user) => {\n                if(err) {\n                    console.log(err)\n                } else {\n                    return done(err, user);\n                }\n            })\n        }\n    )\n);"],"file":"passport-setup.js"}